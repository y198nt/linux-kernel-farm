2025/05/12 14:33:18 reproducing crash 'KASAN: slab-use-after-free Read in cfusbl_device_notify': program crashed: KASAN: slab-use-after-free Read in cfusbl_device_notify
2025/05/12 14:33:18 reproducing crash 'KASAN: slab-use-after-free Read in cfusbl_device_notify': bisect: the chunk can be dropped
2025/05/12 14:33:18 reproducing crash 'KASAN: slab-use-after-free Read in cfusbl_device_notify': bisect: testing without sub-chunk 2/2
2025/05/12 14:33:18 reproducing crash 'KASAN: slab-use-after-free Read in cfusbl_device_notify': bisect: no need to test this chunk, it's definitely needed
2025/05/12 14:33:18 reproducing crash 'KASAN: slab-use-after-free Read in cfusbl_device_notify': bisect: split chunks (needed=true): <4>, <4>, <4>, <3>
2025/05/12 14:33:18 reproducing crash 'KASAN: slab-use-after-free Read in cfusbl_device_notify': bisect: split chunk #0 of len 4 into 2 parts
2025/05/12 14:33:18 reproducing crash 'KASAN: slab-use-after-free Read in cfusbl_device_notify': bisect: testing without sub-chunk 1/2
2025/05/12 14:33:18 reproducing crash 'KASAN: slab-use-after-free Read in cfusbl_device_notify': testing program (duration=1m43s, {Threaded:true Repeat:true RepeatTimes:0 Procs:4 Slowdown:1 Sandbox:none]
2025/05/12 14:33:18 reproducing crash 'KASAN: slab-use-after-free Read in cfusbl_device_notify': detailed listing:
executing program 42:
close$l2cap_control(0xffffffffffffffff)
r0 = openat$l2cap_enable(0xffffffffffffff9c, &(0x7f0000000000), 0x2, 0x0)
open$dir(&(0x7f00000005c0)='./file0\x00', 0x1c0, 0x20)
r1 = openat$fuse(0xffffffffffffff9c, &(0x7f0000000040), 0x2, 0x0)
close$l2cap_enable(r0)
syz_mount_image$fuse(&(0x7f0000000080), &(0x7f0000000600)='./file0\x00', 0x4a00704, &(0x7f00000001c0)={{'fd', 0x3d, r1}, 0x2c, {'rootmode', 0x3d, 0x1000}}, 0x1, 0x0, 0x0)
open$dir(&(0x7f0000000100)='./file0\x00', 0x2000, 0x129)
r2 = openat$l2cap_enable(0xffffffffffffff9c, &(0x7f0000000000), 0x2, 0x0)
close$l2cap_enable(r2)
open$dir(&(0x7f0000000100)='./file0\x00', 0x901, 0x129)
read$l2cap_enable(r0, 0x0, 0x0)
r3 = syz_io_uring_setup(0x7ab2, &(0x7f0000000240)={0x0, 0x805c33, 0x10000, 0xfffffe00, 0x1cf}, &(0x7f0000000080)=<r4=>0x0, &(0x7f00000000c0)=<r5=>0x0)
syz_io_uring_submit(r4, r5, &(0x7f0000000040)=@IORING_OP_POLL_ADD={0x6, 0x0, 0x0, @fd_index=0x3, 0x0, 0x0, 0x0, {0x2000}, 0x1})
io_uring_enter(r3, 0x445f, 0x7253, 0x40, 0x0, 0x0)
write$l2cap_enable(r2, &(0x7f00000000c0)='1', 0x1)
mmap$IORING_OFF_PBUF_RING(&(0x7f0000795000/0x1000)=nil, 0x1000, 0x3000002, 0x12032, 0xffffffffffffffff, 0x80000000)
mmap$IORING_OFF_PBUF_RING(&(0x7f0000abf000/0x1000)=nil, 0x1000, 0x3000002, 0x12032, 0xffffffffffffffff, 0x80000000)
executing program 43:
openat$fuse(0xffffffffffffff9c, &(0x7f0000002000), 0x2, 0x0)
socket$packet(0x11, 0x3, 0x300)
socket$tipc(0x1e, 0x2, 0x0)
openat$l2cap_control(0xffffffffffffff9c, &(0x7f00000000c0), 0x2, 0x0)
syz_init_net_socket$bt_l2cap(0x1f, 0x1, 0x0)
syz_init_net_socket$bt_hci(0x1f, 0x3, 0x1)
r0 = syz_init_net_socket$bt_l2cap(0x1f, 0x5, 0x0)
bind$bt_l2cap(r0, &(0x7f0000000080)={0x1f, 0x0, @fixed={'\xaa\xaa\xaa\xaa\xaa', 0x11}, 0x4, 0x1}, 0xe)
socketpair$tipc(0x1e, 0x2, 0x0, &(0x7f0000000000))
r1 = socket$packet(0x11, 0x3, 0x300)
sendmsg$TIPC_CMD_RESET_LINK_STATS(0xffffffffffffffff, &(0x7f0000000100)={0x0, 0x0, &(0x7f00000000c0)={0x0, 0x28}, 0x1, 0x0, 0x0, 0x48084}, 0x40000)
sendmsg$packet(r1, &(0x7f0000000140)={&(0x7f0000000000), 0x1e, 0x0, 0x0, 0x0, 0x0, 0x1}, 0xfffffffffffffd9a)
socket$packet(0x11, 0x3, 0x300)
socketpair$tipc(0x1e, 0x2, 0x0, &(0x7f0000000040))
syz_init_net_socket$bt_l2cap(0x1f, 0x1, 0x0)
r2 = socket$packet(0x11, 0x3, 0x300)
setsockopt$packet_int(r2, 0x107, 0xf, &(0x7f0000000000)=0x3, 0x4)
sendmsg$packet(r2, &(0x7f0000000180)={&(0x7f0000000040), 0x101f8, &(0x7f0000000100)={0x0}, 0x10, 0x0, 0x0, 0x1}, 0x38)
executing program 44:
r0 = socket$tipc(0x1e, 0x5, 0x0)
bind$tipc(r0, &(0x7f0000000180)=@nameseq={0x1e, 0x1, 0x1, {0x41, 0x2, 0x3}}, 0x10)
bind$tipc(r0, &(0x7f00000003c0)=@nameseq={0x1e, 0x1, 0x0, {0x41, 0x2, 0xfffffffe}}, 0x10)
r1 = syz_io_uring_setup(0x7ab2, &(0x7f00000000c0)={0x0, 0x4959, 0x10000, 0xfffffffe, 0x200}, &(0x7f0000000080)=<r2=>0x0, &(0x7f0000000040)=<r3=>0x0)
syz_io_uring_submit(r2, r3, &(0x7f0000000140)=@IORING_OP_WRITEV={0x2, 0x6e, 0x4006, @fd_index, 0x2, 0x0, 0x0, 0x0, 0x1, {0x3}})
openat$l2cap_control(0xffffffffffffff9c, &(0x7f0000000000), 0x2, 0x0)
io_uring_enter(r1, 0x445f, 0x4d94, 0x40, 0x0, 0x0)
r4 = socket$tipc(0x1e, 0x5, 0x0)
bind$tipc(r0, &(0x7f0000000180)=@nameseq={0x1e, 0x1, 0x1, {0x41, 0x2, 0x4}}, 0x10)
bind$tipc(r4, 0x0, 0x0)
executing program 45:
r0 = socket$nl_generic(0x10, 0x3, 0x10) (async)
r1 = openat$l2cap_control(0xffffffffffffff9c, &(0x7f0000000080), 0x2, 0x0)
close$l2cap_control(r1) (async)
r2 = openat$fuse(0xffffffffffffff9c, &(0x7f0000002000), 0x2, 0x0)
syz_mount_image$fuse(&(0x7f0000002040), &(0x7f0000002080)='./file0\x00', 0x4001, &(0x7f00000020c0)={{'fd', 0x3d, r2}, 0x2c, {'rootmode', 0x3d, 0x4000}}, 0x0, 0x0, 0x0)
syz_mount_image$fuse(0x0, &(0x7f0000000000)='./file0/file0\x00', 0x124802, 0x0, 0xff, 0x0, 0x0)
open$dir(&(0x7f0000000000)='./file0/file0\x00', 0x40040, 0x8) (async)
read$l2cap_control(r1, 0x0, 0x2000) (async, rerun: 64)
syz_genetlink_get_family_id$tipc(&(0x7f0000000040), r0) (rerun: 64)
sendmsg$TIPC_CMD_SHOW_LINK_STATS(r0, &(0x7f0000000100)={0x0, 0x0, &(0x7f00000000c0)={&(0x7f0000000140)=ANY=[], 0x28}, 0x1, 0x0, 0x0, 0x24000102}, 0x4044010)
executing program 46:
r0 = syz_io_uring_setup(0xaa1, &(0x7f0000000240)={0x0, 0xf6fd, 0x10000, 0xfffffdfb, 0x1d2}, &(0x7f0000000080)=<r1=>0x0, &(0x7f0000000540)=<r2=>0x0)
socketpair$tipc(0x1e, 0x2, 0x0, &(0x7f0000000000)={0xffffffffffffffff, <r3=>0xffffffffffffffff})
ioctl$SIOCGETLINKNAME(r3, 0x89e0, &(0x7f00000027c0)={0x2, 0x3})
socket$nl_generic(0x10, 0x3, 0x10)
syz_io_uring_submit(r1, r2, &(0x7f0000000680)=@IORING_OP_POLL_ADD={0x6, 0x40, 0x0, @fd_index=0x5, 0x0, 0x0, 0x0, {0x100}, 0x1})
io_uring_enter(r0, 0x445f, 0x7253, 0x40, 0x0, 0x0)
syz_mount_image$fuse(0x0, 0x0, 0x900400, 0x0, 0xfc, 0x1f, &(0x7f0000000080))
openat$l2cap_enable(0xffffffffffffff9c, &(0x7f0000000000), 0x2, 0x0)
executing program 47:
r0 = socket$nl_generic(0x10, 0x3, 0x10) (async)
r1 = syz_genetlink_get_family_id$tipc(&(0x7f0000000340), 0xffffffffffffffff) (async)
r2 = syz_init_net_socket$bt_rfcomm(0x1f, 0x1, 0x3) (async)
ioctl$HCIINQUIRY(0xffffffffffffffff, 0x800448f0, &(0x7f0000000040)={0x2, 0x4, "ed568e", 0x0, 0x77})
recvfrom$packet(r2, &(0x7f0000000000)=""/53, 0x35, 0x40, 0x0, 0x0)
sendmsg$TIPC_CMD_ENABLE_BEARER(r0, &(0x7f0000000400)={0x0, 0x0, &(0x7f00000003c0)={&(0x7f0000000380)=ANY=[@ANYBLOB='<\x00\x00\x00', @ANYRES16=r1, @ANYBLOB="01002cbd7000fddbdf2501000000000000000141000000)
executing program 9:
r0 = openat$vnet(0xffffffffffffff9c, &(0x7f0000000000), 0x2, 0x0)
ioctl$VHOST_SET_OWNER(r0, 0xaf01, 0x0) (async)
r1 = io_uring_setup(0x1f9a, &(0x7f0000000000)={0x0, 0xf68f, 0x1000, 0x1, 0x26b})
io_uring_register$IORING_UNREGISTER_RING_FDS(r1, 0x15, &(0x7f0000000940)=[{0x0, 0x0, 0x0, 0x0, 0x0}, {0x4, 0x1, 0x0, &(0x7f0000000140)=[{&(0x7f0000000840)=""/220, 0xdc}, {&(0x7f0000000b80)=""/170, 0xaa})
ioctl$VHOST_SET_MEM_TABLE(r0, 0x4008af03, &(0x7f0000000680)={0x4, 0x0, [{0x2000, 0xffffff39, &(0x7f0000000380)=""/180}, {0x10000, 0x1000, &(0x7f0000001300)=""/4096}, {0xeeef0000, 0xe2, &(0x7f0000000500))
r2 = socket$packet(0x11, 0x2, 0x300)
setsockopt$packet_int(r2, 0x107, 0x17, &(0x7f0000000080), 0x4) (async)
io_uring_register$IORING_REGISTER_EVENTFD_ASYNC(r1, 0x7, &(0x7f0000000780), 0x1) (async)
syz_io_uring_submit(0x0, 0x0, &(0x7f0000000040)=@IORING_OP_RECVMSG={0xa, 0xf, 0x14, 0xffffffffffffffff, 0x0, &(0x7f0000000100)={0x0, 0x0, &(0x7f0000000200)=[{&(0x7f00000003c0)=""/250, 0xfa}], 0x1, &(0x7)
r3 = socket$netlink(0x10, 0x3, 0x14)
close$bt_l2cap(0xffffffffffffffff)
socket$netlink(0x10, 0x3, 0x14) (async)
r4 = socket$nl_generic(0x10, 0x3, 0x10)
r5 = syz_genetlink_get_family_id$tipc(&(0x7f0000000040), r4)
sendmsg$TIPC_CMD_SHOW_LINK_STATS(r4, &(0x7f0000000100)={0x0, 0x0, &(0x7f00000000c0)={&(0x7f0000000080)=ANY=[@ANYBLOB="1c000000", @ANYRES16=r5, @ANYBLOB="010028bd7000fbdbdf2501000000000000000b"], 0x28}, )
io_uring_setup(0x3491, &(0x7f0000000000)={0x0, 0xfd3b, 0x1, 0x1, 0x35c})
r6 = syz_genetlink_get_family_id$tipc2(&(0x7f0000000980), 0xffffffffffffffff)
sendmsg$TIPC_NL_BEARER_SET(0xffffffffffffffff, &(0x7f0000000d00)={0x0, 0x0, &(0x7f0000000cc0)={&(0x7f0000000a00)=ANY=[@ANYBLOB=' \x00\x00\x00', @ANYRES16=r6, @ANYBLOB="010027bd7000fddbdf25050000000c0001)
sendmsg$TIPC_NL_BEARER_ENABLE(r3, &(0x7f0000000740)={&(0x7f0000000300)={0x10, 0x0, 0x0, 0x800}, 0xc, &(0x7f00000004c0)={&(0x7f0000000d40)=ANY=[@ANYBLOB="bc010010ca1bfcb8e463272a6f4cb58dfb8d4c1dcc5bf569b)
syz_init_net_socket$bt_l2cap(0x1f, 0x2, 0x0) (async, rerun: 64)
syz_io_uring_setup(0x7aaf, &(0x7f0000000000)={0x0, 0x20805c3a, 0x10000, 0x3, 0x1cf}, &(0x7f00000017c0)=<r7=>0x0, &(0x7f00000000c0)=<r8=>0x0)
syz_io_uring_submit(r7, r8, &(0x7f0000000180)=@IORING_OP_RECVMSG={0xa, 0x40, 0x1, 0xffffffffffffffff, 0x0, &(0x7f0000001580)={&(0x7f0000000240)=@pppol2tpv3in6={0x18, 0x1, {0x0, <r9=>0xffffffffffffffff, )
writev$vsock(r9, &(0x7f0000000080)=[{&(0x7f00000015c0)="66ab6448", 0x4}], 0x1) (async)
connect$tipc(r9, &(0x7f00000001c0)=@id={0x1e, 0x3, 0x3, {0x4e21, 0x4}}, 0x10) (async, rerun: 32)
socketpair$tipc(0x1e, 0x2, 0x0, &(0x7f0000000000)) (async, rerun: 32)
r10 = syz_init_net_socket$bt_hidp(0x1f, 0x3, 0x6)
ioctl$sock_bt_hidp(r10, 0x400448c8, &(0x7f0000000000)=0x7)
r11 = syz_io_uring_setup(0x7ab2, &(0x7f0000000600)={0x0, 0xaa18, 0x8, 0xfffffffe, 0x2d1}, &(0x7f0000000080), &(0x7f0000000040))
syz_io_uring_setup(0x804bc6, &(0x7f0000000340)={0x0, 0x2492, 0x10, 0x3, 0x27d, 0x0, r11}, &(0x7f00000003c0), &(0x7f00000005c0)) (async)
mmap$packet(0xffffffffffffffff, &(0x7f0000000040), 0x0, 0x32ae135bfcda99bf, 0x80000, 0x0)
executing program 9:
r0 = openat$l2cap_control(0xffffffffffffff9c, &(0x7f0000000080), 0x2, 0x0)
close$l2cap_control(r0)
r1 = openat$fuse(0xffffffffffffff9c, &(0x7f0000002000), 0x2, 0x0)
syz_mount_image$fuse(&(0x7f0000002040), &(0x7f0000002080)='./file0\x00', 0x200002, &(0x7f0000000000)={{'fd', 0x3d, r1}, 0x2c, {'rootmode', 0x3d, 0x4000}}, 0x0, 0x0, 0x0)
read$l2cap_control(r0, 0x0, 0x2000)
executing program 9:
r0 = openat$l2cap_enable(0xffffffffffffff9c, &(0x7f0000000000), 0x2, 0x0)
open$dir(&(0x7f00000005c0)='./file0\x00', 0x1c0, 0x20)
r1 = openat$fuse(0xffffffffffffff9c, &(0x7f0000000040), 0x2, 0x0)
close$l2cap_enable(r0)
syz_mount_image$fuse(&(0x7f0000000080), &(0x7f0000000600)='./file0\x00', 0x4a00704, &(0x7f00000001c0)={{'fd', 0x3d, r1}, 0x2c, {'rootmode', 0x3d, 0x1000}}, 0x1, 0x0, 0x0)
open$dir(&(0x7f0000000140)='./file0\x00', 0x2800, 0x1a1)
r2 = syz_io_uring_setup(0x7ab2, &(0x7f0000000240)={0x0, 0xe6bd, 0x10000, 0x3, 0x77}, &(0x7f0000000080)=<r3=>0x0, &(0x7f00000000c0)=<r4=>0x0)
syz_io_uring_submit(r3, r4, &(0x7f0000000040)=@IORING_OP_POLL_ADD={0x6, 0x0, 0x0, @fd_index=0x3, 0x0, 0x0, 0x0, {0x2000}, 0x1})
r5 = openat$vsock(0xffffffffffffff9c, &(0x7f0000000440), 0x400, 0x0)
ioctl$bt_sock_sco(r5, 0x541b, 0x0)
io_uring_enter(r2, 0x2516, 0xcf0c, 0x40, 0x0, 0x0)
openat$l2cap_enable(0xffffffffffffff9c, &(0x7f0000000000), 0x2, 0x0) (async)
open$dir(&(0x7f00000005c0)='./file0\x00', 0x1c0, 0x20) (async)
openat$fuse(0xffffffffffffff9c, &(0x7f0000000040), 0x2, 0x0) (async)
close$l2cap_enable(r0) (async)
syz_mount_image$fuse(&(0x7f0000000080), &(0x7f0000000600)='./file0\x00', 0x4a00704, &(0x7f00000001c0)={{'fd', 0x3d, r1}, 0x2c, {'rootmode', 0x3d, 0x1000}}, 0x1, 0x0, 0x0) (async)
open$dir(&(0x7f0000000140)='./file0\x00', 0x2800, 0x1a1) (async)
syz_io_uring_setup(0x7ab2, &(0x7f0000000240)={0x0, 0xe6bd, 0x10000, 0x3, 0x77}, &(0x7f0000000080), &(0x7f00000000c0)) (async)
syz_io_uring_submit(r3, r4, &(0x7f0000000040)=@IORING_OP_POLL_ADD={0x6, 0x0, 0x0, @fd_index=0x3, 0x0, 0x0, 0x0, {0x2000}, 0x1}) (async)
openat$vsock(0xffffffffffffff9c, &(0x7f0000000440), 0x400, 0x0) (async)
ioctl$bt_sock_sco(r5, 0x541b, 0x0) (async)
io_uring_enter(r2, 0x2516, 0xcf0c, 0x40, 0x0, 0x0) (async)
executing program 9:
syz_init_net_socket$bt_hci(0x1f, 0x3, 0x1)
r0 = syz_init_net_socket$bt_hci(0x1f, 0x3, 0x1) (async)
r1 = socket$nl_generic(0x10, 0x3, 0x10)
sendmsg$TIPC_NL_LINK_GET(r1, &(0x7f0000000280)={0x0, 0x0, &(0x7f00000003c0)={&(0x7f00000002c0)=ANY=[@ANYBLOB="14000000", @ANYRES16=r0, @ANYBLOB="c294acb4ff515f8ff54841"], 0x14}, 0x1, 0x0, 0x0, 0x4000010)
r2 = openat$vsock(0xffffffffffffff9c, &(0x7f0000000000), 0x20c180, 0x0)
close$sock_vsock_seqpacket(r2) (async)
ioctl$sock_bt_hci(r0, 0x400448e2, &(0x7f0000000c80))
executing program 5:
syz_io_uring_setup(0x7ab2, &(0x7f0000000180)={0x0, 0xbbd1, 0x1, 0x1, 0x240}, &(0x7f0000000080)=<r0=>0x0, &(0x7f0000000200)=<r1=>0x0)
syz_io_uring_submit(r0, r1, &(0x7f0000000440)=@IORING_OP_TIMEOUT={0xb, 0x0, 0x0, 0x0, 0x0, &(0x7f0000000100), 0x1, 0x40})
openat$l2cap_control(0xffffffffffffff9c, &(0x7f0000001880), 0x2, 0x0)
syz_init_net_socket$bt_hidp(0x1f, 0x3, 0x6)
socket$nl_generic(0x10, 0x3, 0x10)
syz_init_net_socket$bt_l2cap(0x1f, 0x2, 0x0)
syz_init_net_socket$bt_hci(0x1f, 0x3, 0x1)
io_uring_setup(0x5cfe, &(0x7f0000000140)={0x0, 0xf541, 0x800, 0x7fffff, 0x18d})
socket$netlink(0x10, 0x3, 0x0)
socket$netlink(0x10, 0x3, 0x9)
syz_init_net_socket$bt_l2cap(0x1f, 0x1, 0x0)
syz_io_uring_setup(0x5864, &(0x7f00000005c0)={0x0, 0xdbb7, 0x4000, 0x2, 0x67}, 0x0, 0x0)
socketpair$tipc(0x1e, 0x2, 0x0, &(0x7f0000000040))
syz_io_uring_setup(0x5864, &(0x7f0000000040)={0x0, 0xdbb7, 0x1000, 0x2, 0x66}, 0x0, 0x0)
syz_io_uring_setup(0x7ab2, &(0x7f0000000000)={0x0, 0x5c33, 0x10000, 0xfffffffe, 0x1cf}, 0x0, 0x0)
socket$nl_generic(0x10, 0x3, 0x10)
syz_init_net_socket$bt_hidp(0x1f, 0x3, 0x6)
syz_init_net_socket$bt_l2cap(0x1f, 0x1, 0x0)
socket$nl_generic(0x10, 0x3, 0x10)
syz_init_net_socket$bt_l2cap(0x1f, 0x2, 0x0)
io_uring_setup(0x5d02, &(0x7f0000000140)={0x0, 0xf541, 0x800, 0x7fffff, 0x18d})
socket$netlink(0x10, 0x3, 0x0)
socket$netlink(0x10, 0x3, 0x9)
syz_init_net_socket$bt_l2cap(0x1f, 0x1, 0x0)
syz_init_net_socket$bt_hci(0x1f, 0x3, 0x1)
syz_init_net_socket$bt_l2cap(0x1f, 0x3, 0x0)
r2 = syz_io_uring_setup(0x4646, &(0x7f0000000280)={0x0, 0x580c, 0x8, 0x2, 0x357}, 0x0, 0x0)
syz_io_uring_setup(0x231a, &(0x7f0000000340)={0x0, 0x20b624, 0x10000, 0x50080082, 0xac, 0x0, r2}, 0x0, 0x0)
r3 = socket$netlink(0x10, 0x3, 0x0)
setsockopt$netlink_NETLINK_GET_STRICT_CHK(r3, 0x10e, 0xc, &(0x7f0000000040)=0x800, 0x4)
executing program 8:
r0 = open$dir(&(0x7f00000005c0)='./file0\x00', 0x40842, 0x30)
r1 = openat$l2cap_enable(0xffffffffffffff9c, &(0x7f0000000000), 0x2, 0x0)
close$l2cap_enable(r1)
open$dir(&(0x7f0000000100)='./file0\x00', 0x103481, 0x129)
r2 = syz_init_net_socket$bt_sco(0x1f, 0x5, 0x2)
setsockopt$netlink_NETLINK_GET_STRICT_CHK(0xffffffffffffffff, 0x10e, 0xc, &(0x7f00000003c0)=0x9e9b, 0x4)
r3 = syz_init_net_socket$bt_hci(0x1f, 0x3, 0x1)
ioctl$bt_hci_sock_compat(r3, 0x400448c9, &(0x7f0000000380)={0xf, "64065e8d38cea36c", "fef64a015148", 0xffff, 0x7, "8c04186e2cb8930e", 0x2, 0xffff, 0x401, 0x0, 0xc032, 0x1, 0xc, [0xfffffffc, 0x4, 0x80000)
r4 = syz_init_net_socket$bt_rfcomm(0x1f, 0x1, 0x3)
getsockopt$bt_rfcomm_old(r4, 0x12, 0x3, &(0x7f0000000100), &(0x7f0000000140)=0x4)
r5 = socket$nl_generic(0x10, 0x3, 0x10)
r6 = syz_io_uring_setup(0x55b4, &(0x7f0000000340)={0x0, 0xc0b3, 0x80, 0x2, 0x30c}, &(0x7f00000003c0), &(0x7f0000000400))
io_uring_register$IORING_REGISTER_BUFFERS(r6, 0x0, &(0x7f0000001ac0)=[{&(0x7f00000008c0)=""/4096, 0x1000}, {&(0x7f0000001a80)}], 0x2)
io_uring_register$IORING_REGISTER_BUFFERS(r6, 0x0, &(0x7f0000000240)=[{&(0x7f00000011c0)=""/4096, 0x1000}], 0x1)
syz_mount_image$fuse(&(0x7f00000010c0), &(0x7f0000001100)='./file0\x00', 0x100000, &(0x7f0000000280)=ANY=[@ANYBLOB="66783dca4ff5e69a6d66d75e8cbd732005d903d52ec36010f9e714648dff89f927ba5d9b6e54cefd4b9d62)
r7 = openat$6lowpan_enable(0xffffffffffffff9c, &(0x7f00000001c0), 0x2, 0x0)
read$6lowpan_enable(r7, &(0x7f0000000200)=""/5, 0x5)
r8 = syz_genetlink_get_family_id$tipc(&(0x7f0000000040), 0xffffffffffffffff)
r9 = syz_init_net_socket$bt_rfcomm(0x1f, 0x1, 0x3)
close$bt_rfcomm(r9)
sendmsg$TIPC_CMD_GET_LINKS(r5, &(0x7f0000000180)={&(0x7f0000000000)={0x10, 0x0, 0x0, 0x80000000}, 0xc, &(0x7f00000000c0)={&(0x7f0000000080)={0x24, r8, 0x300, 0x70bd25, 0x25dfdbfe, {{}, {}, {0x8, 0x11, 0)
ioctl$packet(r2, 0x891d, &(0x7f0000000340)={&(0x7f0000000080), 0x0, 0x0})
write$l2cap_enable(r1, &(0x7f0000000440)='0', 0xffffff18)
r10 = syz_init_net_socket$bt_l2cap(0x1f, 0x1, 0x0)
syz_genetlink_get_family_id$tipc2(&(0x7f00000002c0), r10)
mmap$IORING_OFF_SQES(&(0x7f0000ffa000/0x4000)=nil, 0x4000, 0x4, 0x10, r0, 0x10000000)
r11 = syz_init_net_socket$packet_spkt(0xffffffffffffffff, 0x588d4bb3f8f8d510, 0x300)
ioctl$packet_spkt(r11, 0x891a, &(0x7f0000000380)={&(0x7f0000000180), &(0x7f0000000240)={'virt_wifi0\x00', @ifru_names='veth1_to_batadv\x00'}, &(0x7f00000002c0)={0x0, @in={0x2, 0x4e20, @initdev={0xac, 0x)
r12 = syz_io_uring_setup(0x2003, &(0x7f0000000000)={0x0, 0x5c33, 0x10801, 0x3, 0x200}, &(0x7f0000000080), &(0x7f00000000c0))
io_uring_enter(r12, 0xcc4, 0xa81e, 0x69, 0x0, 0x0)
executing program 2:
r0 = syz_init_net_socket$bt_hci(0x1f, 0x3, 0x1)
openat$fuse(0xffffffffffffff9c, &(0x7f0000002000), 0x2, 0x0)
openat$nci(0xffffffffffffff9c, &(0x7f0000000080), 0x2, 0x0)
syz_io_uring_setup(0x7ab2, &(0x7f0000000000)={0x0, 0x5c33, 0x10000, 0xfffffffe, 0x1cf}, 0x0, 0x0)
openat$l2cap_control(0xffffffffffffff9c, &(0x7f0000001880), 0x2, 0x0)
syz_io_uring_setup(0x7ab5, &(0x7f0000000240)={0x0, 0x484f, 0x10300, 0xfffffdfe, 0x1cf}, 0x0, 0x0)
socket$nl_generic(0x10, 0x3, 0x10)
syz_init_net_socket$bt_hidp(0x1f, 0x3, 0x6)
syz_init_net_socket$bt_hidp(0x1f, 0x3, 0x6)
socket$nl_generic(0x10, 0x3, 0x10)
socket$netlink(0x10, 0x3, 0x0)
r1 = socket$packet(0x11, 0x3, 0x300)
sendmsg$TIPC_CMD_RESET_LINK_STATS(0xffffffffffffffff, &(0x7f0000000100)={0x0, 0x0, &(0x7f00000000c0)={0x0, 0x28}, 0x1, 0x0, 0x0, 0x48084}, 0x40000)
setsockopt$packet_int(r1, 0x107, 0xf, &(0x7f0000000000)=0x4, 0x4)
sendmsg$packet(0xffffffffffffffff, &(0x7f0000000140)={&(0x7f0000000000), 0x1a, 0x0, 0x0, 0x0, 0x0, 0x1}, 0x38)
r2 = syz_init_net_socket$bt_hidp(0x1f, 0x3, 0x6)
syz_io_uring_submit(0x0, 0x0, &(0x7f0000000040)=@IORING_OP_WRITE={0x17, 0x2b, 0x3, @fd=r2, 0x1, 0x0, 0x0, 0xa, 0x1})
syz_io_uring_setup(0x2e09, &(0x7f0000000000)={0x0, 0x7ec4, 0x20000, 0x2, 0x22d}, &(0x7f0000000080), &(0x7f00000000c0))
setsockopt$packet_int(0xffffffffffffffff, 0x107, 0xf, &(0x7f0000000000)=0x3, 0x4)
sendmsg$packet(r1, &(0x7f0000000180)={&(0x7f0000000040), 0x8000, &(0x7f0000000100)={0x0}, 0x10, 0x0}, 0x38)
ioctl$sock_bt_hci(r0, 0x400448ca, &(0x7f0000000000)="ae13e308c43a05491acde10b1ecdd8d9e83f834e590b3d3173242dd7553926bd066ae0ac060560201579c3")
executing program 5:
r0 = syz_init_net_socket$bt_l2cap(0x1f, 0x3, 0x0)
connect$bt_l2cap(r0, &(0x7f0000000000)={0x1f, 0x21, @fixed={'\xaa\xaa\xaa\xaa\xaa', 0x10}}, 0xe)
socketpair$tipc(0x1e, 0x5, 0x0, &(0x7f0000000000))
r1 = syz_init_net_socket$bt_bnep(0x1f, 0x3, 0x4)
ioctl$sock_bt_bnep_BNEPCONNADD(r1, 0x400442c8, &(0x7f0000000140)=0x4)
setsockopt$bt_l2cap_L2CAP_new(r0, 0x112, 0x4, &(0x7f0000000040)={0x3, 0x4, 0x9, 0x8e, 0x9, 0x2, 0x7}, 0xc)
syz_genetlink_get_family_id$tipc(0xfffffffffffffffe, 0xffffffffffffffff)
